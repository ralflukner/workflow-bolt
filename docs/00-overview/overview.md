# Workflow-Bolt – Full Application Overview

> **Version**: 2025-06-23  
> **Audience**: New developers, security / compliance reviewers, DevOps engineers, product owners

---

## 1  What does this system do?

Workflow-Bolt is a HIPAA-compliant patient-flow management platform that
bridges a React front-end with Firebase Functions, a PHP Cloud Run
service, and Tebra’s SOAP API.  It automates appointment imports,
real-time status tracking, reporting, and secure credential rotation for
small/medium medical clinics.

* **Front-end**: React 18 + TypeScript + Tailwind CSS.
* **Back-end**:  
  * Node (via Firebase Functions) – unified *tebraProxy* callable.  
  * PHP 8.2 (Cloud Run) – SOAP client & OpenTelemetry tracing.  
  * Google Cloud services – Firestore, Secret Manager, Cloud Monitoring.
* **Security posture**: End-to-end TLS, field-level encryption of PHI,
  Auth0 → Firebase custom-token exchange, principled audit logging.

![high-level Data-flow](../architecture/diagrams/high-level-data-flow.png)

---

## 2  Repository layout (docs)

| Directory | Purpose |
|-----------|---------|
| `00-overview/` | Start here – this file, quick-start, change-log |
| `01-compliance/` | HIPAA & SOC-2 controls, key-rotation, encryption-at-rest |
| `02-infrastructure/` | Terraform / Cloud Run / Firebase setup |
| `03-application/` | React component design, services, parsers |
| `04-ops/` | Run-books, alert policies, deployment guides |
| `05-governance/` | Changelog, versioning, architectural decisions |
| `debugging/` | Troubleshooting playbooks, advanced tracing |
| `tebra-integration/` | Detailed SOAP contract notes & rate-limiting FAQs |

*A full sitemap is generated by `docs/README.md`.*

---

## 3  End-to-end architecture

1. **Schedule import** – User pastes TSV / clinic text → `parseScheduleAuto` →
   secure in-memory store (`SecureStorage`) → Redux-like contexts.
2. **Data sync** – Front-end calls `tebraProxy` callable with Firebase ID
   token.  Proxy forwards to Cloud Run PHP which talks to Tebra SOAP.
3. **Observability** – OpenTelemetry spans emitted from PHP and Functions,
   pushed to Cloud Trace; correlation IDs propagated to front-end.
4. **Credential management** – Rotated by GitHub Actions using Google
   Secret Manager scripts (`scripts/rotate-credentials.ts`).

---

## 4  Key subsystems

### 4.1  Parsing & Secure Storage

* `src/utils/parseScheduleAdvanced.ts` – auto-detects TSV / custom clinic
  formats, integrates with `SecureStorage` for field-level AES-GCM
  encryption and JSON import/export.
* Toggle between *secure* and *legacy* parser via UI switch in
  `ImportSchedule.tsx` (for regression testing).

### 4.2  Back-end proxy chain

* **Firebase Functions** – single entry-point `tebraProxy`, rate-limited,
  validates Auth0-derived Firebase ID token.
* **Cloud Run PHP** – SOAP client, response normalisation, OpenTelemetry
  exporter, health endpoint.

### 4.3  Debug & Ops tooling

* `TebraDebugDashboard*` components provide live health checks and deep
  diagnostics.
* `scripts/` directory contains dozens of one-off helpers for secret
  hygiene, log inspection, deployment sanity checks.

---

## 5  Security & Compliance highlights

* HIPAA “minimum necessary” enforced: PHI never persisted without
  encryption; in dev mode PHI lives only in memory.
* All environment secrets pulled from Google Secret Manager (`pull-secrets.js`)
  – backs up `.env` to `.env.bak.<timestamp>` locally (excluded from git).
* Comprehensive audit logs live in `SecureStorage.auditLog` and Cloud
  Logging sinks (see `monitoring/alerting-policies.yaml`).

---

## 6  Testing strategy

| Layer | Framework | Location |
|-------|-----------|----------|
| Unit  | Jest + RTL | `src/__tests__/unit/` |
| Integration | Jest (live Firebase emulator) | `src/__tests__/` |
| Real API | Flag-gated tests hitting staging infra | `src/__tests__/real-api/` |

Test commands: `npm run test:unit`, `npm run test:integration`, `npm run test:real-api`.

---

## 7  Contributing & Governance

* **Branching model** – `main` → protected; feature branches under
  `feature/*` or `refactor/*`.
* **Commit convention** – Conventional Commits + Jira ticket tags.
* **ADR log** – See `05-governance/CHANGES_SUMMARY.md`.

---

## 8  Quick start for developers

```bash
# 1.  Pull secrets & set up env
node scripts/pull-secrets.js

# 2.  Install deps & run dev server
npm ci
npm run dev

# 3.  Run unit tests
npm run test:unit
```

For deeper topics jump to the appropriate section above.

---

*Last updated 2025-06-23.*
